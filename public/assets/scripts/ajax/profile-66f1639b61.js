{let e=function(t){$.ajax({type:"get",url:$(t).prop("href"),success:function(n){let i=$(t).children("button");i.removeClass("btn-primary"),i.removeClass("btn-danger"),i.removeClass("btn-success"),i.removeClass("btn-info"),i.html("");let l=n.data.status;"Request"==l?(i.addClass("btn-primary"),$($($(t)[0].parentElement).children("div")).html(""),i.html("Add Friend")):"RequestU"==l?(i.remove(),$("#warning-unfriend").remove(),$(".start-chat").remove(),$("#relation-div").html(`\n                        <a id="modify-relation" href="/user/modify-friendship/${n.data.id}">\n                            <button class="btn btn-primary">Add Friend</button>\n                        </a>\n                    `),$("#relation-div").append('<span id=\'disabled-button\' class="d-inline-block" tabindex="0" data-placement="right" data-toggle="tooltip" title="Add friend to start a chat">\n                    <button class="btn btn-primary" style="pointer-events: none;" type="button" disabled><i class="fas fa-comment-alt"></i></button>\n                    </span>'),$((function(){$('[data-toggle="tooltip"]').tooltip()})),$("#modify-relation").click((function(t){console.log("Click"),t.preventDefault(),e(this)})),$("#posts").remove()):"Cancel"==l?(i.html(""),i.addClass("btn-info"),$($($(t)[0].parentElement).children("div")).html("<br><h5>Request Sent</h5>"),i.html("Cancel Request")):(i.addClass("btn-danger"),$("#relation-div").html(`\n                    <div id="warning-unfriend" style="display: inline-block;">\n                        <div data-toggle="modal" data-target="#exampleModal">\n                            <button class="btn btn-danger">Unfriend</button>                    \n                        </div>\n                        \x3c!-- Modal --\x3e\n                        <div class="modal" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">\n                            <div class="modal-dialog" style="top: 40%">\n                                <div class="modal-content">\n                                    <div class="modal-header">\n                                        <h5 class="modal-title" id="">Unfriend</h5>\n                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                                        <span aria-hidden="true">&times;</span>\n                                        </button>\n                                    </div>\n                                    <div class="modal-body" style="text-align: left;">\n                                        Remove this user from your friend list\n                                    </div>\n                                    <div class="modal-footer">\n                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n                                        <a id="modify-relation" href="/user/modify-friendship/${n.data.profUser_id}">\n                                            <button type="button" class="btn btn-danger" data-dismiss="modal">\n                                                Unfriend\n                                            </button>\n                                        </a>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    `),$("#modify-relation").click((function(t){console.log("Click"),t.preventDefault(),e(this)})),$("#decline").remove(),$("#disabled-button").remove())},error:function(e){console.log(e.responseText)}})};$("#modify-relation").click((function(t){console.log("Click"),t.preventDefault(),e(this)}));let t=function(e){$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$("#decline").remove();let t=$("#modify-relation button");t.removeClass("btn-success"),t.addClass("btn-primary"),t.html("Add Friend")},error:function(e){console.log(e.responseText)}})};$("#decline").click((function(e){e.preventDefault(),t(this)}));let n=function(e){$.ajax({type:"post",url:$(e).prop("action"),data:$(e).serialize(),success:function(t){let n=t.data.comment,s=i(n);n.user.avatar||$(s).find("img").attr("src","/uploads/users/default/avatar"),$(`#post-${e.postid.value} .all-comments`).append(s);let o=$("#post-"+e.postid.value).children(".response-box").children("div").children(".toggle-comment"),d=o.attr("data-comments");d++,o.attr("data-comments",""+d),o.html(`(${d})`);let r=$("#comment-"+n._id);r.find(".delete > a").click((function(e){e.preventDefault(),l(this)})),r.find(".toggle-like").click((function(e){e.preventDefault(),a($(this))})),r.find(".like-com").click((function(){"Like"==$(this).children("div").html()?$(this).children("div").html("Unlike"):$(this).children("div").html("Like")}))},error:function(e){console.log(e.responseText)}})},i=function(e){return $(`<div id='comment-${e._id}' class="comment">\n        <div class=" pl-3 pb-2 d-flex">\n            <div class="m-2">\n                    <img src="${e.user.avatar}" alt="Profile" width="30" height="30" style="border-radius: 100%;">\n            </div>\n            <div class="d-flex" style="width: 100%; justify-content: space-between;">\n                <div class="post-user-name pt-1 pl-2" style="width: 84%;">\n                    <div class="" style="font-weight: 500;">\n                        ${e.user.name}\n                        <span class="" style="font-size: 13px; color: grey;">Just Now</span>\n                    </div>\n                    <div style="display: inline-flex; width: 100%; justify-content: space-between;">\n                        <div style="display: flex;">\n                            ${e.comment}\n                            <a href="/like/toggle/?id=${e._id}&type=Comment" style="font-size: 15px;" class="toggle-like pl-3 like-com">\n                                <div>Like</div>\n                            </a>\n                        </div>\n                        <div class="pr-3 like-count">\n                            <div data-likes="${e.likes.length}">\n                                ${e.likes.length} Likes\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="delete">\n                    <a href="/comment/delete/${e._id}" style="font-size: 15px;">Delete</a>\n                </div>\n            </div>\n        </div>`)};$(".post-comments").children("form").submit((function(e){e.preventDefault(),n(this),$($(this).children("input")[0]).prop("value","")}));let l=function(e){$.ajax({type:"get",url:$(e).prop("href"),success:function(e){let t=$($("#comment-"+e.data.comment_id)[0].parentElement.parentElement).children(".response-box").children("div").children(".toggle-comment"),n=t.attr("data-comments");n--,t.attr("data-comments",""+n),t.html(`(${n})`),$("#comment-"+e.data.comment_id).remove()},error:function(e){console.log(e.responseText)}})};$(".delete").children("a").click((function(e){e.preventDefault(),l(this)}));let a=function(e){$.ajax({type:"get",url:e.prop("href"),success:function(t){let n=$(e[0].parentElement.parentElement).children(".like-count").children("div"),i=n.attr("data-likes");t.data.deleted?i--:i++,n.attr("data-likes",""+i),n.html(i+" Likes")}})};$(".toggle-like").click((function(e){e.preventDefault(),a($(this))}));let s=function(e){$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$("#post-"+e.data.post_id).remove()},error:function(e){console.log(e.responseText)}})};$(".ajax-delete").click((function(e){e.preventDefault(),s(this)}))}